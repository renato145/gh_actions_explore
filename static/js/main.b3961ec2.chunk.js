(this.webpackJsonpperu_news=this.webpackJsonpperu_news||[]).push([[0],{60:function(e,t,r){},61:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(0),c=r.n(a),i=r(16),s=r.n(i),o=r(6),l=r(35),u=r(12),d=r(7),f=r.n(d),j=r(13),b=r(14),m=r.n(b),v={enabled:!1,retry:!1,refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1,cacheTime:36e5},p=function(){var e=Object(j.a)(f.a.mark((function e(t){var r,n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("https://api.github.com/repos/renato145/peru_news/contents/data/summary?ref=main",{});case 2:if(r=e.sent,n=r.data,200===(a=r.status)){e.next=7;break}throw new Error("status: ".concat(a));case 7:return e.abrupt("return",n.map((function(e){return{download_url:e.download_url,name:e.name.split(".json")[0]}})).sort((function(e,t){return t.name.localeCompare(e.name)})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=r(17),x=r(64),h=r(63),g=function(){var e=Object(j.a)(f.a.mark((function e(t,r){var n,a,c,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.url,console.log("fetching summary data ".concat(t," ").concat(n)),e.next=4,m.a.get(n);case 4:if(a=e.sent,c=a.data,200===(i=a.status)){e.next=9;break}throw new Error("status: ".concat(i));case 9:return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),w=r(9),N=r(34),y=function(e,t,r,n){var a=new Map;return t.forEach((function(t){var r=e[t];void 0!==r&&Object.entries(r).forEach((function(e){var t,r=Object(w.a)(e,2),c=r[0],i=r[1],s=null!==(t=a.get(c))&&void 0!==t?t:new Map;Object.entries(i).forEach((function(e){var t,r=Object(w.a)(e,2),a=r[0],c=r[1];-1===n.indexOf(a)&&s.set(a,(null!==(t=s.get(a))&&void 0!==t?t:0)+c)})),a.set(c,s)}))})),Array.from(a).map((function(e){var t=Object(w.a)(e,2),n=t[0],a=t[1];return[n,Array.from(a).sort((function(e,t){return t[1]-e[1]})).slice(0,r)]}))},k=Object(N.a)((function(e,t){var r,n;return{data:{},topk:0,activeUrls:[],activeData:[],selectedWord:"",filters:null!==(r=null===(n=localStorage.getItem("filters"))||void 0===n?void 0:n.split(","))&&void 0!==r?r:[],add:function(t){e((function(e){var r=e.data;return{data:Object.assign(r,t)}}))},addActiveUrl:function(t){e((function(e){var r=e.data,n=e.activeUrls,a=e.topk,c=e.filters;if(n.indexOf(t)>-1)return{};var i=n.concat(t);return 0===a?{activeUrls:i}:{activeUrls:i,activeData:y(r,i,a,c)}}))},rmActiveUrl:function(t){e((function(e){var r=e.data,n=e.activeUrls,a=e.topk,c=e.filters;if(n.indexOf(t)>-1){var i=n.filter((function(e){return e!==t}));return 0===a?{activeUrls:i}:{activeUrls:i,activeData:y(r,i,a,c)}}return{}}))},isActive:function(e){return t().activeUrls.indexOf(e)>-1},setSelectedWord:function(t){return e({selectedWord:t})},setTopK:function(t){e((function(){return{topk:t}}))},addFilter:function(t){e((function(e){var r=e.data,n=e.activeUrls,a=e.topk,c=e.filters;if(c.indexOf(t)>-1)return{};var i=c.concat(t);return localStorage.setItem("filters",i.join()),{activeData:y(r,n,a,i),filters:i}}))},rmFilter:function(t){e((function(e){var r=e.data,n=e.activeUrls,a=e.topk,c=e.filters;if(c.indexOf(t)>-1){var i=c.filter((function(e){return e!==t}));return localStorage.setItem("filters",i.join()),{activeData:y(r,n,a,i),filters:i}}return{}}))}}})),U=function(e){return Object(x.a)(Object(h.a)(e,"yyyyMMdd",new Date),"dd/MM/Y")},C=function(e){var t=e.date,r=e.url,c=e.load,i=e.className,s=void 0===i?"":i,l=function(e){return Object(o.d)(["data",{url:e}],g,v)}(r),u=l.isError,d=l.isLoading,f=l.isSuccess,j=l.refetch,b=k(function(e){return function(t){return{add:t.add,addUrl:function(){return t.addActiveUrl(e)},removeDate:function(){return t.rmActiveUrl(e)},isActive:t.isActive(e)}}}(r)),m=b.add,p=b.addUrl,x=b.removeDate,h=b.isActive,w=Object(a.useCallback)((function(){h||u?x():f&&p()}),[h,u,x,f,p]),N=Object(a.useCallback)((function(){if(f)w();else{if(d)return;j().then((function(e){e&&(m(Object(O.a)({},r,e)),p())}))}}),[m,p,d,f,j,w,r]);return Object(a.useEffect)((function(){c&&N()}),[c]),u?null:Object(n.jsx)("div",{className:"".concat(s," p-2 transition cursor-pointer ").concat(h?"bg-green-600 text-gray-50":"bg-gray-300"," ").concat(d?"animate-pulse":""),onClick:function(){return N()},children:Object(n.jsx)("p",{className:"font-semibold pointer-events-none",children:U(t)})})},F=function(e){var t=e.className,r=null!==t&&void 0!==t?t:"h-5 w-5";return Object(n.jsxs)("svg",{className:"animate-spin mr-3 ".concat(r),fill:"none",viewBox:"0 0 24 24",children:[Object(n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),Object(n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},D=function(e){var t=e.n,r=e.loadN,a=Object(o.d)("files",p,Object(u.a)(Object(u.a)({},v),{},{enabled:!0,retry:!0})),c=a.data,i=a.error,s=a.status;return Object(n.jsx)("div",{className:"-mt-2 -ml-2 flex flex-wrap",children:s===o.b.Error?Object(n.jsxs)("p",{children:["Couldn't load files: ",Object(n.jsx)("span",{children:String(i)})]}):s===o.b.Success&&c?c.slice(0,t).map((function(e,t){var a=e.download_url,c=e.name;return Object(n.jsx)(C,{className:"mt-2 ml-2",date:c,url:a,load:t<r},t)})):Object(n.jsx)("div",{className:"w-full flex justify-center",children:Object(n.jsx)(F,{className:"h-10 w-10"})})})},E=function(){var e=Object(j.a)(f.a.mark((function e(t){var r,n,a,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("https://raw.githubusercontent.com/renato145/peru_news/main/settings.json",{});case 2:if(r=e.sent,n=r.data,200===(a=r.status)){e.next=7;break}throw new Error("status: ".concat(a));case 7:return c=new Map,n.sources.forEach((function(e){var t=e.name,r=e.url;return c.set(t,r)})),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=r(36),S=function(e){return{rmFilter:e.rmFilter}},A=function(e){var t=e.word,r=e.className,a=void 0===r?"":r,c=Object(M.a)(e,["word","className"]),i=k(S).rmFilter;return Object(n.jsx)("div",Object(u.a)(Object(u.a)({className:"px-2 rounded-md bg-red-400 hover:bg-red-600 text-sm text-white font-medium transition-colors cursor-pointer ".concat(a),onClick:function(){i(t)}},c),{},{children:t}))},W=function(e){return{selectedWord:e.selectedWord,setSelectedWord:e.setSelectedWord,addFilter:e.addFilter}},_=function(e){var t=e.data,r=k(W),c=r.selectedWord,i=r.setSelectedWord,s=r.addFilter,o=Object(a.useMemo)((function(){return t.map((function(e){var t=Object(w.a)(e,2);t[0];return t[1]})).reduce((function(e,t){return Math.max(e,t)}))}),[t]);return Object(n.jsx)("div",{className:"flex flex-col space-y-1",children:t.map((function(e,t){var r=Object(w.a)(e,2),a=r[0],l=r[1];return Object(n.jsxs)("div",{className:"group relative flex items-center h-8",onClick:function(){return function(e){i(c!==e?e:"")}(a)},children:[Object(n.jsxs)("div",{className:"absolute flex w-full justify-between pl-2",children:[Object(n.jsxs)("p",{className:"pointer-events-none ".concat(c===a?"font-semibold":""),children:[a," (",l,")"]}),Object(n.jsx)("p",{className:"mr-2 font-bold text-xs cursor-pointer text-gray-400 hover:text-gray-900",onClick:function(e){return function(e,t){e.stopPropagation(),c===t&&i(""),s(t)}(e,a)},children:"X"})]}),Object(n.jsx)("div",{className:"h-full transition-all duration-300 cursor-pointer group-hover:bg-blue-300 ".concat(c===a?"bg-blue-400":"bg-blue-200"),style:{width:"".concat(100*l/o,"%")}})]},t)}))})},T=function(e){var t=e.activeData,r=e.activeUrls,n=e.setTopK,a=e.filters;e.addFilter;return{activeData:t,activeUrls:r,setTopK:n,filters:a}},I=function(e){var t=e.topk,r=k(T),c=r.activeData,i=r.activeUrls,s=r.setTopK,l=r.filters,d=Object(o.d)("name2url",E,Object(u.a)(Object(u.a)({},v),{},{enabled:!0,retry:!0})).data;return Object(a.useEffect)((function(){s(t)}),[s,t]),Object(n.jsx)("div",{className:"mt-2",children:0===c.length?Object(n.jsx)("div",{className:"mt-10 flex justify-center",children:Object(n.jsx)(F,{className:"h-14 w-14"})}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("p",{className:"font-semibold",children:["Loaded data: ",i.length]}),Object(n.jsx)("div",{className:"flex flex-wrap -ml-1",children:l.map((function(e,t){return Object(n.jsx)(A,{className:"ml-1 mt-0.5",word:e},t)}))}),Object(n.jsx)("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-4",children:c.map((function(e,t){var r=Object(w.a)(e,2),a=r[0],c=r[1];return Object(n.jsxs)("div",{className:"px-4 py-2 bg-blue-50",children:[Object(n.jsx)("a",{className:"capitalize text-lg font-semibold",href:null===d||void 0===d?void 0:d.get(a),target:"_black",rel:"noopener",children:a.replace("_"," ")}),Object(n.jsx)("div",{className:"my-2",children:Object(n.jsx)(_,{data:c})})]},t)}))})]})})},K=new o.a,L=function(){return Object(n.jsxs)(o.c,{queryCache:K,children:[Object(n.jsxs)("div",{className:"m-4",children:[Object(n.jsx)(D,{n:10,loadN:5}),Object(n.jsx)(I,{topk:10})]}),Object(n.jsx)(l.ReactQueryDevtools,{initialIsOpen:!0})]})},z=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,65)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;r(e),n(e),a(e),c(e),i(e)}))};r(60);s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(L,{})}),document.getElementById("root")),z()}},[[61,1,2]]]);
//# sourceMappingURL=main.b3961ec2.chunk.js.map